(self.webpackChunklite=self.webpackChunklite||[]).push([[1429],{90194:(e,t,n)=>{"use strict";n.d(t,{w:()=>c});var r=n(67294),i=n(55099),l=n(95760),o=n(51512),s=n(6688),u=n(16139),c=function(e){var t=e.buttonSize,n=void 0===t?"LARGE":t,c=e.buttonStyle,a=void 0===c?"STRONG":c,d=e.newsletterV3Id,w=e.showMailIcon,b=void 0===w||w,m=e.onClick,v=e.width,E=e.buttonText,f=void 0===E?"Get this newsletter":E,g=e.redirectUrl,S=(0,o.Qi)(),V=(0,l.Av)(),p=(0,s.I)();return r.createElement(i.z,{buttonStyle:a,onClick:function(){V.event("newsletterV3.subscribeClicked",{newsletterV3Id:d,source:S}),m()},size:n,width:v,href:g},b&&r.createElement("span",{className:p((function(){return{marginRight:"8px"}})),"aria-hidden":"true"},r.createElement(u.Z,null)),f)}},31429:(e,t,n)=>{"use strict";n.d(t,{x:()=>H,B:()=>Y});var r=n(67154),i=n.n(r),l=n(63038),o=n.n(l),s=n(28655),u=n.n(s),c=n(71439),a=n(67294),d=n(90194),w=n(59713),b=n.n(w),m=n(46829),v=n(76532),E=n(81474),f=n(95760),g=n(85277);function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function V(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(Object(n),!0).forEach((function(t){b()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(){var e=u()(["\n  mutation unsubscribeNewsletterV3($newsletterV3Id: ID!) {\n    unsubscribeNewsletterV3(newsletterV3Id: $newsletterV3Id)\n  }\n"]);return p=function(){return e},e}function h(){var e=u()(["\n  mutation subscribeNewsletterV3($newsletterV3Id: ID!, $shouldRecordConsent: Boolean) {\n    subscribeNewsletterV3(\n      newsletterV3Id: $newsletterV3Id\n      shouldRecordConsent: $shouldRecordConsent\n    )\n  }\n"]);return h=function(){return e},e}function y(){var e=u()(["\n  fragment useNewsletterV3Subscription_newsletterV3_viewerEdge on NewsletterV3 {\n    viewerEdge {\n      id\n      isSubscribed\n    }\n  }\n"]);return y=function(){return e},e}function N(){var e=u()(["\n  fragment useNewsletterV3Subscription_newsletterV3 on NewsletterV3 {\n    id\n    slug\n    name\n    collection {\n      slug\n    }\n    user {\n      username\n    }\n  }\n"]);return N=function(){return e},e}(0,c.Ps)(N());var I=(0,c.Ps)(y()),T=(0,c.Ps)(h()),C=(0,c.Ps)(p()),O=n(62181),R=n(42933),_=n(92528),P=n(41707),x=n(1072),k=n(55099),L=n(82318),A=n(66266),B=n(98024),G=n(51512),U=n(14391),j=n(8403),$=n(67297),D=n(51064),F=n(27952),M=n(534);function z(){var e=u()(["\n  fragment NewsletterV3SubscribeButton_newsletterV3 on NewsletterV3 {\n    id\n    name\n    slug\n    type\n    user {\n      name\n      username\n    }\n    collection {\n      slug\n      ...SusiClickable_collection\n      ...collectionDefaultBackgroundTheme_collection\n    }\n    ...SusiClickable_newsletterV3\n  }\n  ","\n  ","\n  ","\n"]);return z=function(){return e},e}var W="newsletter_v3_promo",Y=(0,c.Ps)(z(),O.Os,O.GB,M.Gi),H=function(e){var t,n,r,l=e.newsletterV3,s=e.buttonLayout,u=void 0===s?"MULTI-LINE":s,c=e.helperTextColor,w=void 0===c?"LIGHTER":c,b=e.showHelperText,S=void 0===b||b,p=e.showMailIcon,h=void 0===p||p,y=e.buttonSize,N=void 0===y?"LARGE":y,z=e.buttonStyle,Y=void 0===z?"STRONG":z,H=e.redirectUrl,Q=(0,v.H)().value,Z=l.id,X=l.collection?l.collection:void 0,q=l.user?l.user:void 0,J=(0,g.w)(),K=(0,j.PM)(),ee=(0,$.v9)((function(e){return e.config.productName})),te=(0,D.O)(!1),ne=o()(te,3),re=ne[0],ie=ne[1],le=ne[2];switch(l.type){case U.Rr.NEWSLETTER_TYPE_COLLECTION:t=l.name,n="Get this newsletter",r="You’re signed up for ".concat(t,".");break;case U.Rr.NEWSLETTER_TYPE_AUTHOR:t=null==q?void 0:q.name,n="Subscribe",r="You’re subscribed to ".concat(t)}var oe=function(e,t){var n=e.id,r=e.slug,i=e.collection,l=e.user,s=null!=t?t:e.name,u=a.useState(!1),c=o()(u,2),d=c[0],w=c[1],b=(0,E.T)({newsletterSlug:r,collectionSlug:null==i?void 0:i.slug,username:null==l?void 0:l.username}).viewerEdge,S=a.useState(!1),p=o()(S,2),h=p[0],y=p[1];a.useEffect((function(){y(!(null==b||!b.isSubscribed))}),[null==b?void 0:b.isSubscribed]);var N=(0,f.Av)(),O=(0,g.w)(),R=(0,v.H)().value;d&&N.event("newsletterV3.subscribe.error",{newsletterV3Id:n});var _=(0,m.useMutation)(T,{variables:{newsletterV3Id:n,shouldRecordConsent:!1},onCompleted:function(e){var t=e.subscribeNewsletterV3;w(!t),t&&y(!0)},update:function(e,t){var r,i={id:"NewsletterV3ViewerEdge:newsletterId:".concat(n,"-viewerId:").concat(null==R?void 0:R.id),fragment:I,fragmentName:"useNewsletterV3Subscription_newsletterV3_viewerEdge"},l=e.readFragment(i);e.writeFragment(V(V({},i),{},{data:V(V({},l),{},{isSubscribed:null===(r=t.data)||void 0===r?void 0:r.subscribeNewsletterV3})}))}}),P=o()(_,1)[0],x=(0,m.useMutation)(C,{variables:{newsletterV3Id:n},onCompleted:function(e){var t=e.unsubscribeNewsletterV3;w(!t),t&&(y(!1),O({duration:"NEXTPAGE",message:"",toastStyle:"NEWSLETTER_UNSUBSCRIBE",extraParams:{newsletterName:s,unsubscribeFn:function(){return y(!1)}}}))},update:function(e,t){var r,i={id:"NewsletterV3ViewerEdge:newsletterId:".concat(n,"-viewerId:").concat(null==R?void 0:R.id),fragment:I,fragmentName:"useNewsletterV3Subscription_newsletterV3_viewerEdge"},l=e.readFragment(i);e.writeFragment(V(V({},i),{},{data:V(V({},l),{},{isSubscribed:null===(r=t.data)||void 0===r?void 0:r.unsubscribeNewsletterV3})}))}}),k=o()(x,1)[0];return{isSubscribed:h,hasError:d,setSubscribe:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];w(!1),e?P({variables:{newsletterV3Id:n,shouldRecordConsent:t}}):k()}}}(l,t),se=oe.isSubscribed,ue=oe.hasError,ce=oe.setSubscribe;a.useEffect((function(){if(K){var e=(0,G.P7)(K||"").susiEntry;["collection_newsletter_v3_landing","newsletter_v3_promo"].includes(void 0===e?"":e)&&se&&J({duration:"NEXTPAGE",message:"",toastStyle:"NEWSLETTER_SUBSCRIBE",extraParams:{newsletterName:t,unsubscribeFn:function(){return ce(!1)}}})}}),[K,se]);var ae=function(e){var t=e.children;return a.createElement(R.x,{margin:"COMPACT"===u?"10px 20px 10px 0":"",xs:{margin:"10px 0 0 0"}},t)},de=function(e){var t=e.children;return a.createElement(R.x,{maxWidth:"COMPACT"===u?"380px":"",margin:"COMPACT"===u?"10px 0 10px 0":"10px 0 0 0"},a.createElement(B.F,{scale:"S",color:w},t))},we=function(){var e=(0,F.Zul)(Z),r={buttonSize:N,buttonStyle:Y,newsletterV3Id:l.id,onClick:function(){Q&&(Q&&Q.allowEmailAddressSharingEditorWriter?ce(!0,!1):ie())},showMailIcon:h,buttonText:n,redirectUrl:H};return a.createElement(ae,null,Q?a.createElement(a.Fragment,null,a.createElement(d.w,r),a.createElement(_.Q,{onConfirm:function(){return ce(!0,!0)},isVisible:re,hide:le,titleText:"Confirm your subscription to ".concat(t),confirmText:"Confirm now",buttonStyle:"STRONG",buttonSize:"LARGE",showCancelButton:!1,withCloseButton:!1,isDestructiveAction:!1},"By confirming, you agree to share your email address with the editors of newsletters and writers you've subscribed to so they can stay in contact with you outside of ".concat(ee,". You can opt out of sharing your email address by unsubscribing in your Settings."))):a.createElement(O.R9,{operation:"register",newsletterV3:l,collection:X,actionUrl:e,susiEntry:W,redirectTo:H},a.createElement(d.w,i()({},r,{redirectUrl:void 0}))))};return a.createElement(a.Fragment,null,a.createElement(P.Z,null,(function(e){return a.createElement(x.f,{theme:(0,M.jN)(X,e)},se?a.createElement(a.Fragment,null,a.createElement(ae,null,a.createElement(k.z,{buttonStyle:"SUBTLE",size:"SMALL",onClick:function(){return ce(!1)}},"Unsubscribe")),S&&a.createElement(de,null,r)):a.createElement(G.cW,{source:{newsletterV3Id:l.id},extendSource:!0},a.createElement(we,null),S&&(Q?a.createElement(de,null,"Emails will be sent to ",Q.email,".",a.createElement(R.x,null,a.createElement(O.R9,{operation:"login",newsletterV3:l,collection:X,susiEntry:W},a.createElement(L.r,{onClick:function(){},linkStyle:"OBVIOUS",inline:!0,target:"_blank"},"Not you?")))):a.createElement(de,null,"You'll need to sign in or create an account to receive this newsletter."))))})),ue&&a.createElement(A.F,{toastStyle:"RETRYABLE_ERROR",isVisible:ue,hide:function(){}}))}},81474:(e,t,n)=>{"use strict";n.d(t,{T:()=>u});var r=n(28655),i=n.n(r),l=n(46829),o=n(71439);function s(){var e=i()(["\n  query NewsletterV3ViewerEdge($newsletterSlug: ID!, $collectionSlug: ID, $username: ID) {\n    newsletterV3(\n      newsletterSlug: $newsletterSlug\n      collectionSlug: $collectionSlug\n      username: $username\n    ) {\n      ... on NewsletterV3 {\n        id\n        viewerEdge {\n          id\n          isSubscribed\n        }\n      }\n    }\n  }\n"]);return s=function(){return e},e}var u=function(e){var t,n=e.newsletterSlug,r=void 0===n?"":n,i=e.collectionSlug,o=e.username,s=(0,l.useQuery)(c,{variables:{newsletterSlug:r,collectionSlug:i,username:o},ssr:!1,skip:!r}),u=s.loading,a=s.error,d=s.data;return u?{loading:u}:a?{error:a}:{viewerEdge:null==d||null===(t=d.newsletterV3)||void 0===t?void 0:t.viewerEdge}},c=(0,o.Ps)(s())}}]);
//# sourceMappingURL=https://stats.medium.build/lite/sourcemaps/1429.82f766ce.chunk.js.map