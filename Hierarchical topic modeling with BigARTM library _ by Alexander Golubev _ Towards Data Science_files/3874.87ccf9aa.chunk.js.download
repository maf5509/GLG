(self.webpackChunklite=self.webpackChunklite||[]).push([[3874],{93874:(e,n,t)=>{"use strict";t.d(n,{h:()=>oe,k:()=>ue});var a,r=t(28655),i=t.n(r),l=t(63038),o=t.n(l),u=t(71439),c=t(67294),s=t(42963),m=t(46829),d=t(58875),g=t.n(d),p=t(76532),f=t(42933),h=t(82318),v=t(98024),E=t(95760),x=t(6688),b=t(79208),I=t(90038),C=function(e){return{backgroundColor:e.baseColor.background.light,borderColor:e.baseColor.border.light,borderRadius:"3px",borderWidth:"1px",alignItems:"center",padding:"25px 20px 25px 20px",marginTop:"",borderStyle:"solid"}},y=function(){var e=(0,x.I)();return c.createElement("div",{className:e([k,C])},c.createElement(f.x,{textAlign:"center"},c.createElement(f.x,null,"1000 x 1000"),c.createElement(f.x,null,"pixels")))},S=function(){return c.createElement(f.x,{marginRight:"5px",display:"inline-block"},c.createElement(v.F,{scale:"S",color:"ERROR"},"That file doesn't meet our requirements. Try another."))},R=function(){return c.createElement(f.x,{marginTop:"8px"},c.createElement(f.x,{marginRight:"5px",display:"inline-block"},c.createElement(v.F,{scale:"S",color:"ERROR"},"We couldn't process your request.")),c.createElement(f.x,{marginRight:"5px",display:"inline-block"},c.createElement(v.F,{scale:"S"},"Try again, or"," ",c.createElement(h.r,{inline:!0,linkStyle:"OBVIOUS",href:"https://help.medium.com/hc/en-us"},"search our help center for support."))))};!function(e){e.Success="success",e.UploadError="uploadError",e.InvalidError="invalidError"}(a||(a={}));var k={height:"132px",width:"132px",display:"flex",flexDirection:"row",justifyContent:"center"},D=function(e){var n=e.setImageId,t=e.initialImageId,r=e.source,i=(0,x.I)(),l=(0,E.Av)(),u=(0,p.H)().value,s=c.useState({imageId:t,imageWidth:0,imageHeight:0}),m=o()(s,2),d=m[0],g=m[1],v=c.useState(null),C=o()(v,2),D=C[0],w=C[1],L=function(e){w(e),l.event("user.updateAvatarResult",{userId:null==u?void 0:u.id,source:r,uploadResult:e})},T=(0,b.JA)((function(e,t,r){var i=t.height,l=t.width,o=e.value.fileId;g({imageId:o,imageHeight:i,imageWidth:l}),i<parseInt("1000px",10)||l<parseInt("1000px",10)?(L(a.InvalidError),H()):(n(o),L(a.Success),r())}),(function(){L(a.UploadError)}),(function(){L(a.InvalidError)})),F=T.inputRef,U=T.fireClick,B=function(){l.event("user.updateAvatarClick",{userId:null==u?void 0:u.id,source:r,hasImage:!!d.imageId}),U()},H=function(){g({imageId:"",imageWidth:0,imageHeight:0}),n("")},A=c.useCallback((function(){return c.createElement(f.x,{marginBottom:"10px"},c.createElement("input",{type:"file","aria-hidden":"true",ref:F,className:i({display:"none"})}),c.createElement(h.r,{inline:!0,linkStyle:"OBVIOUS",onClick:B},"Add photo"))}),[i,B,F]),P=c.useCallback((function(){return c.createElement("div",{className:i([k])},c.createElement("div",{className:i((function(){return{backgroundImage:"url(".concat((0,I.W6)({miroId:d.imageId||"",width:d.imageWidth||0,height:d.imageHeight||0}),")"),backgroundPosition:"center",backgroundRepeat:"no-repeat",backgroundSize:"contain",height:"100%",width:"100%",borderRadius:"3px",display:"flex",flexDirection:"row"}}))}))}),[i,d]),M=c.useCallback((function(){return c.createElement(f.x,{display:"inline-block",marginBottom:"15px"},d.imageId?c.createElement(P,null):c.createElement(y,null))}),[d]);return c.createElement(f.x,{display:"flex",flexDirection:"column",maxWidth:"132px"},c.createElement(f.x,{display:"inline-block",float:"right"},c.createElement(M,null)),c.createElement(A,null),D===a.UploadError&&c.createElement(R,null),D===a.InvalidError&&c.createElement(S,null))},w=t(48573),L=function(e){var n=e.label,t=e.onChangeFn,a=e.onBlurFn,r=e.value,i=e.errorMessage,l=e.characterCountLimit;return c.createElement(c.Fragment,null,c.createElement(f.x,{marginBottom:"15px",textAlign:"left"},c.createElement(v.F,{scale:"L",tag:"h4"},n)),c.createElement(w.n,{scale:"L",onChange:t,value:r,errorMessage:i,onBlur:a,ariaLabel:n,characterCountLimit:l}))},T=t(92528),F=t(29035);function U(){var e=i()(["\n  mutation userCompleteProfileMutation(\n    $userId: ID!\n    $name: String!\n    $bio: String!\n    $imageId: String!\n  ) {\n    userCompleteProfile(userId: $userId, name: $name, bio: $bio, imageId: $imageId)\n  }\n"]);return U=function(){return e},e}function B(){var e=i()(["\n  fragment UserCompleteProfileDialog_user on User {\n    id\n    name\n    bio\n    imageId\n    hasCompletedProfile\n  }\n"]);return B=function(){return e},e}var H={min:3,max:50,message:"Please try another name that’s between 3 and 50 characters."},A={min:10,max:160,message:"Please try another description that’s between 10 and 160 characters."},P=function(e,n){var t=e.min,a=e.max,r=e.message;return function(e){var i=e.target.value;n(i.length<t||i.length>a?r:void 0)}},M=function(e){var n=(0,p.H)().value;return{shouldShowDialog:g().canUseDOM&&!(0,F.ic)(navigator.userAgent)&&(null==n?void 0:n.id)===e.id}},O=function(e){var n=e.setHasCompletedProfile,t=e.user,a=(0,E.Av)(),r=(0,p.H)().value,i=c.useState(!1),l=o()(i,2),u=l[0],s=l[1],m=V(),d=o()(m,1)[0],g=c.useState((null==t?void 0:t.imageId)||""),h=o()(g,2),x=h[0],b=h[1],I=c.useState((null==t?void 0:t.name)||""),C=o()(I,2),y=C[0],S=C[1],R=c.useState((null==t?void 0:t.bio)||""),k=o()(R,2),w=k[0],F=k[1],U=c.useState(),B=o()(U,2),O=B[0],N=B[1],$=c.useState(),_=o()($,2),W=_[0],G=_[1],z=P(H,N),Q=P(A,G),q=c.useCallback((function(){r&&(s(!0),a.event("user.completedProfile",{userId:r.id,changedName:(null==t?void 0:t.name)!==y,changedBio:(null==t?void 0:t.bio)!==w,changedImage:(null==t?void 0:t.imageId)!==x,hasName:!!y,hasBio:!!w,hasImage:!!x}),d({variables:{userId:r.id,name:y,bio:w,imageId:x}}).then((function(){s(!1),n(!0)})))}),[r,d,s,t,y,w,x]),Y=M(t).shouldShowDialog;return c.useEffect((function(){Y&&a.event("user.presentedCompleteProfileDialog",{userId:null==r?void 0:r.id})}),[Y]),Y?c.createElement(c.Fragment,null,c.createElement(T.Q,{confirmText:"Continue",titleText:"Complete your profile",isDestructiveAction:!1,onConfirm:q,isVisible:!0,hide:function(){},withCloseButton:!1,showCancelButton:!1,disableConfirm:u},c.createElement(v.F,{scale:"L",color:"DARKER"},"Readers like learning a bit more about their writers"),c.createElement(f.x,{marginTop:"48px",marginBottom:"28px",display:"flex",flexDirection:"row"},c.createElement(f.x,{overflow:"visible",maxHeight:"200px"},c.createElement(D,{setImageId:b,initialImageId:x,source:"userCompleteProfileDialog"})),c.createElement(f.x,{marginLeft:"48px",textAlign:"left"},c.createElement(f.x,{key:"name"},c.createElement(L,{label:"Full name",onChangeFn:function(e){return S(e.target.value)},onBlurFn:z,value:y,errorMessage:O})),c.createElement(f.x,{key:"bio",marginTop:"40px"},c.createElement(L,{label:"Bio (optional, max 160 characters)",onChangeFn:function(e){return F(e.target.value)},onBlurFn:Q,value:w,errorMessage:W,characterCountLimit:160})))))):null},N=(0,u.Ps)(B()),V=function(){return(0,m.useMutation)($)},$=(0,u.Ps)(U()),_=t(23279),W=t.n(_),G=t(55099),z=t(67297),Q=t(51064),q=t(27952);function Y(){var e=i()(["\n  query userDomainValidityQuery($domain: String!) {\n    userDomainValidity(domain: $domain)\n  }\n"]);return Y=function(){return e},e}function j(){var e=i()(["\n  mutation createUserDomainMutation($domain: String!) {\n    userDomainLink(domain: $domain) {\n      __typename\n      ... on CustomDomainFailure {\n        reason\n      }\n    }\n  }\n"]);return j=function(){return e},e}function J(){var e=i()(["\n  fragment UserSubdomainOnboardingDialog_user on User {\n    id\n    customDomainState {\n      pending {\n        status\n      }\n      live {\n        status\n      }\n    }\n    username\n  }\n"]);return J=function(){return e},e}var K=function(e){var n,t,a=e.user,r=e.isVisible,i=e.hide,l=e.redirectTo,u=e.redirectOnHide,s=void 0!==u&&u,m=e.refreshOnHide,d=void 0!==m&&m,h=(0,x.I)(),b=(0,E.Av)(),I=(0,p.H)().value,C=null!=I&&I.username?function(e){return e.toLowerCase().replace(/[_.]/g,"-").replace(/[^a-z0-9-]/g,"").replace(/-+/g,"-").replace(/^-/,"").replace(/-$/,"")}(I.username):"",y=c.useState(C),S=o()(y,2),R=S[0],k=S[1],D=(0,Q.O)(!1),L=o()(D,3),F=L[0],U=L[1],B=L[2],H=c.useState(!1),A=o()(H,2),P=A[0],M=A[1],O=c.useState(!1),N=o()(O,2),V=N[0],$=N[1],_=ae(R),Y=re(R),j=c.useState(null),J=o()(j,2),K=J[0],X=J[1],ee=(0,z.v9)((function(e){return e.config.productName})),te=Z(),ie=o()(te,1)[0],le=ne(_),oe=le.isValidityLoading,ue=le.validityResult,ce=le.checkValidity,se=c.useCallback(W()((function(e){ce(e),M(!1)}),500),[]),me=c.useCallback((function(e){var n=e.target.value;P||M(!0),X(null),se({domain:n}),k(n)}),[ce,P]),de=c.useCallback((function(){$(!0),b.event("user.claimedSubdomain",{userId:null==I?void 0:I.id,source:"subdomain_dialog",changedUsername:(null==I?void 0:I.username)!==R}),ie({variables:{domain:_}}).then((function(e){var n,t,a,r,l="Something went wrong. Please try again with a different name.";if("CustomDomain"===(null===(n=e.data)||void 0===n||null===(t=n.userDomainLink)||void 0===t?void 0:t.__typename))U(),i();else if("CustomDomainFailure"===(null===(a=e.data)||void 0===a||null===(r=a.userDomainLink)||void 0===r?void 0:r.__typename)){var o=e.data.userDomainLink.reason||l;X(o)}else X(l);$(!1)}))}),[ie,b,I,_,R]),ge=c.useCallback((function(){s&&l(Y),B(),d&&window.location.reload()}),[Y,s,d]),pe=!(null==a||null===(n=a.customDomainState)||void 0===n||!n.pending)||!(null==a||null===(t=a.customDomainState)||void 0===t||!t.live),fe=!!I&&a.id===I.id&&!pe&&g().canUseDOM;if(c.useEffect((function(){r&&fe&&b.event("user.presentedClaimSubdomainDialog",{userId:null==I?void 0:I.id})}),[r,fe]),!fe)return null;var he=!P&&!oe&&(null==ue?void 0:ue.userDomainValidity);return c.createElement(c.Fragment,null,c.createElement(T.Q,{confirmText:"Claim URL",titleText:"Claim your ".concat(ee," URL"),isDestructiveAction:!1,onConfirm:de,isVisible:r,hide:i,withCloseButton:!1,showCancelButton:!1,secondaryButton:c.createElement(G.z,{href:(0,q.mcw)(),size:"REGULAR"},"Learn More"),hideOnConfirm:!1,disableConfirm:V||!!K||!he},"All your stories show up on your profile, and it now comes with a personalized URL. The name you pick below will also be your username on ",ee,".",c.createElement(f.x,{marginBottom:"14px",marginTop:"32px",display:"flex",flexDirection:"column"},c.createElement(w.n,{ariaLabel:"Profile domain",onChange:me,value:R,errorMessage:null!=K?K:void 0,hideErrorIcon:!0}),!K&&c.createElement(f.x,{display:"inline-block",marginTop:"8px"},c.createElement("table",{className:h({display:"table",marginLeft:"auto",marginRight:"auto",textAlign:"left",borderSpacing:"4px",tableLayout:"fixed",maxWidth:"100%"})},c.createElement("tbody",null,c.createElement("tr",null,c.createElement("td",{className:h({paddingRight:"4px",verticalAlign:"top"})},c.createElement(v.F,{color:"LIGHTER",scale:"M",tag:"h4"},c.createElement("strong",null,"URL"))),c.createElement("td",null,c.createElement(v.F,{color:"LIGHTER",scale:"M"},_))),c.createElement("tr",null,c.createElement("td",{className:h({paddingRight:"4px",verticalAlign:"top"})},c.createElement(v.F,{color:"LIGHTER",scale:"M",tag:"h4"},c.createElement("strong",null,"Username"))),c.createElement("td",{className:h({marginBottom:"12px",marginTop:"10px"})},c.createElement(v.F,{color:"LIGHTER",scale:"M"},"@",R))),c.createElement("tr",null,c.createElement("td",null),c.createElement("td",{className:h({visibility:R===a.username?"hidden":"visible"})},c.createElement(v.F,{color:"LIGHTER",scale:"M"},"@",a.username," will no longer be valid")))))))),c.createElement(T.Q,{confirmText:"Done",titleText:"You're all set.",isDestructiveAction:!1,onConfirm:function(){},isVisible:F,hide:ge,withCloseButton:!1,showCancelButton:!1},"Your profile is now available at your ",ee," URL.",c.createElement(f.x,null,c.createElement(f.x,{display:"inline-block",marginTop:"28px"},c.createElement("table",{className:h({display:"table",marginLeft:"auto",marginRight:"auto",textAlign:"left",tableLayout:"fixed",maxWidth:"100%"})},c.createElement("tbody",null,c.createElement("tr",null,c.createElement("td",{className:h({marginBottom:"12px",paddingRight:"8px",verticalAlign:"top"})},c.createElement(v.F,{color:"LIGHTER",scale:"M",tag:"h4"},c.createElement("strong",null,"URL"))),c.createElement("td",null,c.createElement(v.F,{color:"LIGHTER",scale:"M",tag:"h4"},_))),c.createElement("tr",{className:h({paddingTop:"8px"})},c.createElement("td",{className:h({paddingRight:"8px",verticalAlign:"top"})},c.createElement(v.F,{color:"LIGHTER",scale:"M",tag:"h4"},c.createElement("strong",null,"Username"))),c.createElement("td",{className:h({marginBottom:"12px"})},c.createElement(v.F,{color:"LIGHTER",scale:"M",tag:"h4"},"@",R)))))))))},X=(0,u.Ps)(J()),Z=function(){return(0,m.useMutation)(ee)},ee=(0,u.Ps)(j()),ne=function(e){var n=(0,m.useQuery)(te,{variables:{domain:e},ssr:!1});return{isValidityLoading:n.loading,validityResult:n.data,checkValidity:n.refetch}},te=(0,u.Ps)(Y()),ae=function(e){var n=(0,z.v9)((function(e){return e.config.authDomain})).split(":")[0];return"".concat(e,".").concat(n)},re=function(e){var n=(0,z.v9)((function(e){return e.config.authDomain}));return"https://".concat(e,".").concat(n)},ie=t(8403);function le(){var e=i()(["\n  fragment UserSubdomainFlow_user on User {\n    id\n    hasCompletedProfile\n    name\n    bio\n    imageId\n    ...UserCompleteProfileDialog_user\n    ...UserSubdomainOnboardingDialog_user\n  }\n  ","\n  ","\n"]);return le=function(){return e},e}var oe=function(e){var n=e.user,t=e.redirectOnComplete,a=void 0!==t&&t,r=e.refreshOnComplete,i=void 0!==r&&r,l=e.forceVisible,u=void 0!==l&&l,m="true"===(0,ie.Wd)("showDomainSetup")||u,d=(0,Q.O)(m),g=o()(d,3),p=g[0],f=g[2],h=c.useState(n.hasCompletedProfile),v=o()(h,2),E=v[0],x=v[1],b=c.useState(null),I=o()(b,2),C=I[0],y=I[1],S=M(n).shouldShowDialog&&!E&&(!n.name||!n.bio||!n.imageId);return C?c.createElement(s.l,{to:C,replace:!0}):c.createElement(c.Fragment,null,c.createElement(K,{isVisible:p&&!S,hide:u?function(){}:f,user:n,redirectTo:y,redirectOnHide:a,refreshOnHide:i}),p&&S?c.createElement(O,{user:n,setHasCompletedProfile:x}):null)},ue=(0,u.Ps)(le(),N,X)}}]);
//# sourceMappingURL=https://stats.medium.build/lite/sourcemaps/3874.87ccf9aa.chunk.js.map